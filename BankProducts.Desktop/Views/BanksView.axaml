<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:BankProducts.Desktop.ViewModels"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="600"
             x:Class="BankProducts.Desktop.Views.BanksView"
             x:DataType="vm:BanksViewModel">

    <UserControl.Styles>
        <Style Selector="Button:disabled">
            <Setter Property="Background" Value="#1a1a1aff"/>
            <Setter Property="Foreground" Value="#E0E0E0"/>
            <Setter Property="Opacity" Value="1"/>
        </Style>
    </UserControl.Styles>

    <Grid RowDefinitions="Auto,*,Auto">
        <!-- Add New Bank Form -->
        <Border Grid.Row="0" Background="#E8E8E8" Padding="15" Margin="0,0,0,10" CornerRadius="5">
            <StackPanel Orientation="Horizontal" Spacing="15">
                <TextBox Text="{Binding NewBankName}"
                         Watermark="Име на банка"
                         Width="220"
                         FontSize="14"/>
                <Button Content="Добави банка"
                        Command="{Binding AddBankCommand}"
                        Background="#2E7D32"
                        Foreground="White"
                        FontWeight="SemiBold"
                        Padding="20,10"/>
            </StackPanel>
        </Border>

        <!-- Banks List -->
        <DataGrid Grid.Row="1"
                  ItemsSource="{Binding Banks}"
                  SelectedItem="{Binding SelectedBank}"
                  AutoGenerateColumns="False"
                  IsReadOnly="True"
                  CanUserResizeColumns="True"
                  GridLinesVisibility="Horizontal"
                  FontSize="14"
                  Background="White"
                  Foreground="Black"
                  BorderBrush="#BDBDBD"
                  BorderThickness="1">
            <DataGrid.Columns>
                <DataGridTextColumn Header="Име" Binding="{Binding Name}" Width="*" CanUserResize="True"/>
                <DataGridTextColumn Header="Създадена" Binding="{Binding CreatedAt, StringFormat='{}{0:dd.MM.yyyy}'}" Width="120" CanUserResize="True"/>
            </DataGrid.Columns>
        </DataGrid>

        <!-- Actions Panel -->
        <Border Grid.Row="2" Background="#E8E8E8" Padding="15" Margin="0,10,0,0" CornerRadius="5">
            <StackPanel>
                <!-- Normal view -->
                <StackPanel Orientation="Horizontal" Spacing="15"
                            IsVisible="{Binding !IsEditing}">
                    <Button Content="Редактирай"
                            Command="{Binding StartEditCommand}"
                            IsEnabled="{Binding SelectedBank, Converter={x:Static ObjectConverters.IsNotNull}}"
                            Background="#1976D2"
                            Foreground="White"
                            FontWeight="SemiBold"
                            Padding="20,10"/>
                    <Button Content="Изтрий"
                            Command="{Binding DeleteBankCommand}"
                            IsEnabled="{Binding SelectedBank, Converter={x:Static ObjectConverters.IsNotNull}}"
                            Background="#C62828"
                            Foreground="White"
                            FontWeight="SemiBold"
                            Padding="20,10"/>
                </StackPanel>

                <!-- Edit view -->
                <StackPanel IsVisible="{Binding IsEditing}" Spacing="15">
                    <StackPanel Orientation="Horizontal" Spacing="15">
                        <TextBox Text="{Binding EditBankName}"
                                 Watermark="Име на банка"
                                 Width="220"
                                 FontSize="14"/>
                        <Button Content="Запази"
                                Command="{Binding SaveEditCommand}"
                                Background="#2E7D32"
                                Foreground="White"
                                FontWeight="SemiBold"
                                Padding="20,10"/>
                        <Button Content="Отказ"
                                Command="{Binding CancelEditCommand}"
                                Background="#757575"
                                Foreground="White"
                                FontWeight="SemiBold"
                                Padding="20,10"/>
                    </StackPanel>
                </StackPanel>
            </StackPanel>
        </Border>
    </Grid>
</UserControl>
